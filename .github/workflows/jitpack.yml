name: Check Jitpack Artifact

on:
  push:
    branches:
      - '**'

jobs:
  check-artifact:
    runs-on: ubuntu-latest
    steps:
      - name: Download Jitpack Artifact by commit hash
        run: |
          URL="https://jitpack.io/com/github/nbauma109/jd-gui-duo/jd-gui-duo/${GITHUB_SHA:0:7}/jd-gui-duo-${GITHUB_SHA:0:7}.zip"
          echo "Downloading URL $URL"
          curl --location --fail --connect-timeout 3000 --max-time 6000 "$URL" --output "jd-gui-duo-${GITHUB_SHA:0:7}.zip"
      - name: Check if the ZIP file is valid
        run: |
          if unzip -tq "jd-gui-duo-${GITHUB_SHA:0:7}.zip"; then
            echo "The ZIP file is valid."
          else
            echo "The ZIP file is invalid."
            exit 1
          fi
      - name: Download Jitpack Artifact by branch SNAPSHOT
        run: |
          URL="https://jitpack.io/com/github/nbauma109/jd-gui-duo/jd-gui-duo/${GITHUB_REF##*/}-SNAPSHOT/jd-gui-duo-${GITHUB_REF##*/}-SNAPSHOT.zip"
          echo "Downloading URL $URL"
          curl --location --fail --connect-timeout 3000 --max-time 6000 "$URL" --output "jd-gui-duo-${GITHUB_REF##*/}-SNAPSHOT.zip"
      - name: Check if the ZIP file is valid
        run: |
          if unzip -tq "jd-gui-duo-${GITHUB_REF##*/}-SNAPSHOT.zip"; then
            echo "The ZIP file is valid."
          else
            echo "The ZIP file is invalid."
            exit 1
          fi
